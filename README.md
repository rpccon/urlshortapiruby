# README

## General information:

* It is created with Ruby.
* The application is hosted in Heroku.
* It uses postgreSQL as a database, it is hosted on Heroku too.
* In the database are created 2 tables, one to manage URLs information and the other to store recently URLs visited.
* The background-job of the title was created using the Ruby class Thread. Visiting a          procedure in the database to update the shortest url of the already created URL.
* It includes HTTParty to get tag title of URL.



## Endpoints information:
  The domain of the API application is [https://urlshortapiserver.herokuapp.com](https://urlshortapiserver.herokuapp.com)


  For test the functionality you can add to the domain:

  * **/validateFullPath**: For use this endpoint you need to attached to this request the full url in the **body** of the same, with this structure **{ 'url':[here goes your URL]  }** and type of request must to be **POST**, you can use **Postman** to test it. For example, this image explains the procedure [exampleValidate.png](https://github.com/rpccon/urlshortapiruby/blob/master/images/exampleValidate.png)

  * **/redirect/[shortest URL]**. It is easy to use, this endpoint represens the link response in the explained image. It is composed by **domain + /redirect + /[id identifier generated by the application]**. For example the response of the past image attached: [https://urlshortapiserver.herokuapp.com/redirect/emg](https://urlshortapiserver.herokuapp.com/redirect/emg), will open the origin page.
  * **/top100**, you can use it only adding this text and you'll get urls recently used with the title(of the long url) included, with the format [[itemA url, itemA title], ...]. You can test it following [https://urlshortapiserver.herokuapp.com/top100](https://urlshortapiserver.herokuapp.com/top100).


  **Extra information:**

  * ValidateFullPath endpoint creates the shortest url of the long URL in the database, if you run again the same link, will return as a first time the shortest URL. It does't generate de shortest URL again, take it from the database.


  * The algorithm in top100 is easy, in the database I have a table URLs_visited, where I save all urls visited but always asking if url is here, because if is true I need to update the time it was visited, because when user runs the endpoint I get the limit of 100 items in table oredered from up to down, to get recently items.

  * Remember list '/top100' has only links are recently "VISITED", it means only if you use '/redirect' endpoint will be added to that list. Isn't added to the list when you use '/validateFullPath' endpoint, because it creates the shortest url in the database only.


    


## Shortest URL implementation

  First to start work in it, I had to understand how does work tinyUrl. The idea was for each long URL user inserts in the endpoint is important to create an only one identifier and associate it with the long url in the database. First I created an endpoint to receive the url from the user, after that I used "Ruby - Hashids" library to create an specific, unique and small hash id and save it in the database. Before create the hash I created and returned the idNumber of the url in the database, with the idNumber I created the hash and after that I updated to the database by procedure. It is a simple logic, when the user use /redirect/ with the hash generated I go to the database and comeback with the long url to be redirected.


## Configuration of the application
  For install the application in your computer you need to:

  * Be sure you have Rails installed.
  * Clone the project in one directory.
  * Open the root folder from console.
  * Run in console /bin/bash.
  * Run in console "Bundle install"  -> helps to install packages.
  * Run in console "rails server", to run the application.
  * After that you need to open the browser with the respective port, and use the endpoints explained in the start of the document.

